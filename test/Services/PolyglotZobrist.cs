using System;

namespace ChessDroid.Services
{
    /// <summary>
    /// Computes Polyglot Zobrist hash keys from FEN positions.
    /// Uses the standard Polyglot random numbers for compatibility with .bin books.
    ///
    /// Key components:
    /// - 768 values for piece/square (12 pieces × 64 squares)
    /// - 4 values for castling rights
    /// - 8 values for en passant file
    /// - 1 value for side to move
    /// </summary>
    public static class PolyglotZobrist
    {
        // Piece indices in Polyglot format: bp, wp, bn, wn, bb, wb, br, wr, bq, wq, bk, wk
        private const int BP = 0, WP = 1, BN = 2, WN = 3, BB = 4, WB = 5;
        private const int BR = 6, WR = 7, BQ = 8, WQ = 9, BK = 10, WK = 11;

        /// <summary>
        /// Computes the Polyglot hash key for a FEN position.
        /// </summary>
        public static ulong ComputeKey(string fen)
        {
            ulong key = 0;

            string[] parts = fen.Split(' ');
            if (parts.Length < 4)
                return 0;

            string board = parts[0];
            string turn = parts[1];
            string castling = parts[2];
            string enPassant = parts[3];

            // Parse board
            int rank = 7;
            int file = 0;

            foreach (char c in board)
            {
                if (c == '/')
                {
                    rank--;
                    file = 0;
                }
                else if (char.IsDigit(c))
                {
                    file += c - '0';
                }
                else
                {
                    int pieceIndex = GetPieceIndex(c);
                    if (pieceIndex >= 0)
                    {
                        int square = rank * 8 + file;
                        key ^= Random64Piece[pieceIndex * 64 + square];
                    }
                    file++;
                }
            }

            // Castling rights
            if (castling.Contains('K')) key ^= Random64Castle[0];
            if (castling.Contains('Q')) key ^= Random64Castle[1];
            if (castling.Contains('k')) key ^= Random64Castle[2];
            if (castling.Contains('q')) key ^= Random64Castle[3];

            // En passant - only include if an en passant capture is actually possible
            // (Polyglot spec: only hash ep if an enemy pawn can capture)
            if (enPassant != "-" && enPassant.Length >= 2)
            {
                int epFile = enPassant[0] - 'a';
                int epRank = enPassant[1] - '1';
                if (epFile >= 0 && epFile < 8 && CanCaptureEnPassant(board, epFile, epRank, turn))
                {
                    key ^= Random64EnPassant[epFile];
                }
            }

            // Side to move (Polyglot: XOR if white to move)
            if (turn == "w")
                key ^= Random64Turn;

            return key;
        }

        /// <summary>
        /// Checks if an en passant capture is actually possible by verifying
        /// an enemy pawn exists on an adjacent file at the correct rank.
        /// </summary>
        private static bool CanCaptureEnPassant(string board, int epFile, int epRank, string turn)
        {
            // Parse the board into a 2D array [rank, file] where rank 0 = rank 1
            char[,] squares = new char[8, 8];
            int rank = 7, file = 0;
            foreach (char c in board)
            {
                if (c == '/')
                {
                    rank--;
                    file = 0;
                }
                else if (char.IsDigit(c))
                {
                    for (int j = 0; j < c - '0'; j++)
                        squares[rank, file++] = '.';
                }
                else
                {
                    squares[rank, file++] = c;
                }
            }

            // The capturing pawn is on the same rank as the en passant square's adjacent rank
            // EP on rank 6 (index 5): black pawn moved to rank 5 (index 4), white pawn captures from rank 5
            // EP on rank 3 (index 2): white pawn moved to rank 4 (index 3), black pawn captures from rank 4
            int pawnRank;
            char enemyPawn;
            if (epRank == 5) // ep square on rank 6, white captures
            {
                pawnRank = 4; // rank 5 (0-indexed)
                enemyPawn = 'P';
            }
            else if (epRank == 2) // ep square on rank 3, black captures
            {
                pawnRank = 3; // rank 4 (0-indexed)
                enemyPawn = 'p';
            }
            else
            {
                return false;
            }

            // Check adjacent files for the capturing pawn
            if (epFile > 0 && squares[pawnRank, epFile - 1] == enemyPawn)
                return true;
            if (epFile < 7 && squares[pawnRank, epFile + 1] == enemyPawn)
                return true;

            return false;
        }

        private static int GetPieceIndex(char piece)
        {
            return piece switch
            {
                'p' => BP,
                'P' => WP,
                'n' => BN,
                'N' => WN,
                'b' => BB,
                'B' => WB,
                'r' => BR,
                'R' => WR,
                'q' => BQ,
                'Q' => WQ,
                'k' => BK,
                'K' => WK,
                _ => -1
            };
        }

        #region Polyglot Random Numbers

        // Standard Polyglot random numbers (from polyglot source code)
        // These are the official values used by all Polyglot-compatible programs

        private static readonly ulong Random64Turn = 0x_F8D626AAAF278509UL;

        private static readonly ulong[] Random64Castle = new ulong[]
        {
            0x_31D71DCE64B2C310UL, // White kingside
            0x_F165B587DF898190UL, // White queenside
            0x_A57E6339DD2CF3A0UL, // Black kingside
            0x_1EF6E6DBB1961EC9UL  // Black queenside
        };

        private static readonly ulong[] Random64EnPassant = new ulong[]
        {
            0x_70CC73D90BC26E24UL, // a-file
            0x_E21A6B35DF0C3AD7UL, // b-file
            0x_003A93D8B2806962UL, // c-file
            0x_1C99DED33CB890A1UL, // d-file
            0x_CF3145DE0ADD4289UL, // e-file
            0x_D0E4427A5514FB72UL, // f-file
            0x_77C621CC9FB3A483UL, // g-file
            0x_67A34DAC4356550BUL  // h-file
        };

        // 768 values: 12 pieces × 64 squares
        // Order: black pawn (0-63), white pawn (64-127), black knight (128-191), etc.
        private static readonly ulong[] Random64Piece = new ulong[]
        {
            // Black Pawn (index 0)
            0x_9D39247E33776D41UL, 0x_2AF7398005AAA5C7UL, 0x_44DB015024623547UL, 0x_9C15F73E62A76AE2UL,
            0x_75834465489C0C89UL, 0x_3290AC3A203001BFUL, 0x_0FBBAD1F61042279UL, 0x_E83A908FF2FB60CAUL,
            0x_0D7E765D58755C10UL, 0x_1A083822CEAFE02DUL, 0x_9605D5F0E25EC3B0UL, 0x_D021FF5CD13A2ED5UL,
            0x_40BDF15D4A672E32UL, 0x_011355146FD56395UL, 0x_5DB4832046F3D9E5UL, 0x_239F8B2D7FF719CCUL,
            0x_05D1A1AE85B49AA1UL, 0x_679F848F6E8FC971UL, 0x_7449BBFF801FED0BUL, 0x_7D11CDB1C3B7ADF0UL,
            0x_82C7709E781EB7CCUL, 0x_F3218F1C9510786CUL, 0x_331478F3AF51BBE6UL, 0x_4BB38DE5E7219443UL,
            0x_AA649C6EBCFD50FCUL, 0x_8DBD98A352AFD40BUL, 0x_87D2074B81D79217UL, 0x_19F3C751D3E92AE1UL,
            0x_B4AB30F062B19ABFUL, 0x_7B0500AC42047AC4UL, 0x_C9452CA81A09D85DUL, 0x_24AA6C514DA27500UL,
            0x_4C9F34427501B447UL, 0x_14A68FD73C910841UL, 0x_A71B9B83461CBD93UL, 0x_03488B95B0F1850FUL,
            0x_637B2B34FF93C040UL, 0x_09D1BC9A3DD90A94UL, 0x_3575668334A1DD3BUL, 0x_735E2B97A4C45A23UL,
            0x_18727070F1BD400BUL, 0x_1FCBACD259BF02E7UL, 0x_D310A7C2CE9B6555UL, 0x_BF983FE0FE5D8244UL,
            0x_9F74D14F7454A824UL, 0x_51EBDC4AB9BA3035UL, 0x_5C82C505DB9AB0FAUL, 0x_FCF7FE8A3430B241UL,
            0x_3253A729B9BA3DDEUL, 0x_8C74C368081B3075UL, 0x_B9BC6C87167C33E7UL, 0x_7EF48F2B83024E20UL,
            0x_11D505D4C351BD7FUL, 0x_6568FCA92C76A243UL, 0x_4DE0B0F40F32A7B8UL, 0x_96D693460CC37E5DUL,
            0x_42E240CB63689F2FUL, 0x_6D2BDCDAE2919661UL, 0x_42880B0236E4D951UL, 0x_5F0F4A5898171BB6UL,
            0x_39F890F579F92F88UL, 0x_93C5B5F47356388BUL, 0x_63DC359D8D231B78UL, 0x_EC16CA8AEA98AD76UL,

            // White Pawn (index 1)
            0x_5355F900C2A82DC7UL, 0x_07FB9F855A997142UL, 0x_5093417AA8A7ED5EUL, 0x_7BCBC38DA25A7F3CUL,
            0x_19FC8A768CF4B6D4UL, 0x_637A7780DECFC0D9UL, 0x_8249A47AEE0E41F7UL, 0x_79AD695501E7D1E8UL,
            0x_14ACBAF4777D5776UL, 0x_F145B6BECCDEA195UL, 0x_DABF2AC8201752FCUL, 0x_24C3C94DF9C8D3F6UL,
            0x_BB6E2924F03912EAUL, 0x_0CE26C0B95C980D9UL, 0x_A49CD132BFBF7CC4UL, 0x_E99D662AF4243939UL,
            0x_27E6AD7891165C3FUL, 0x_8535F040B9744FF1UL, 0x_54B3F4FA5F40D873UL, 0x_72B12C32127FED2BUL,
            0x_EE954D3C7B411F47UL, 0x_9A85AC909A24EAA1UL, 0x_70AC4CD9F04F21F5UL, 0x_F9B89D3E99A075C2UL,
            0x_87B3E2B2B5C907B1UL, 0x_A366E5B8C54F48B8UL, 0x_AE4A9346CC3F7CF2UL, 0x_1920C04D47267BBDUL,
            0x_87BF02C6B49E2AE9UL, 0x_092237AC237F3859UL, 0x_FF07F64EF8ED14D0UL, 0x_8DE8DCA9F03CC54EUL,
            0x_9C1633264DB49C89UL, 0x_B3F22C3D0B0B38EDUL, 0x_390E5FB44D01144BUL, 0x_5BFEA5B4712768E9UL,
            0x_1E1032911FA78984UL, 0x_9A74ACB964E78CB3UL, 0x_4F80F7A035DAFB04UL, 0x_6304D09A0B3738C4UL,
            0x_2171E64683023A08UL, 0x_5B9B63EB9CEFF80CUL, 0x_506AACF489889342UL, 0x_1881AFC9A3A701D6UL,
            0x_6503080440750644UL, 0x_DFD395339CDBF4A7UL, 0x_EF927DBCF00C20F2UL, 0x_7B32F7D1E03680ECUL,
            0x_B9FD7620E7316243UL, 0x_05A7E8A57DB91B77UL, 0x_B5889C6E15630A75UL, 0x_4A750A09CE9573F7UL,
            0x_CF464CEC899A2F8AUL, 0x_F538639CE705B824UL, 0x_3C79A0FF5580EF7FUL, 0x_EDE6C87F8477609DUL,
            0x_799E81F05BC93F31UL, 0x_86536B8CF3428A8CUL, 0x_97D7374C60087B73UL, 0x_A246637CFF328532UL,
            0x_043FCAE60CC0EBA0UL, 0x_920E449535DD359EUL, 0x_70EB093B15B290CCUL, 0x_73A1921916591CBDUL,

            // Black Knight (index 2)
            0x_56436C9FE1A1AA8DUL, 0x_EFAC4B70633B8F81UL, 0x_BB215798D45DF7AFUL, 0x_45F20042F24F1768UL,
            0x_930F80F4E8EB7462UL, 0x_FF6712FFCFD75EA1UL, 0x_AE623FD67468AA70UL, 0x_DD2C5BC84BC8D8FCUL,
            0x_7EED120D54CF2DD9UL, 0x_22FE545401165F1CUL, 0x_C91800E98FB99929UL, 0x_808BD68E6AC10365UL,
            0x_DEC468145B7605F6UL, 0x_1BEDE3A3AEF53302UL, 0x_43539603D6C55602UL, 0x_AA969B5C691CCB7AUL,
            0x_A87832D392EFEE56UL, 0x_65942C7B3C7E11AEUL, 0x_DED2D633CAD004F6UL, 0x_21F08570F420E565UL,
            0x_B415938D7DA94E3CUL, 0x_91B859E59ECB6350UL, 0x_10CFF333E0ED804AUL, 0x_28AED140BE0BB7DDUL,
            0x_C5CC1D89724FA456UL, 0x_5648F680F11A2741UL, 0x_2D255069F0B7DAB3UL, 0x_9BC5A38EF729ABD4UL,
            0x_EF2F054308F6A2BCUL, 0x_AF2042F5CC5C2858UL, 0x_480412BAB7F5BE2AUL, 0x_AEF3AF4A563DFE43UL,
            0x_19AFE59AE451497FUL, 0x_52593803DFF1E840UL, 0x_F4F076E65F2CE6F0UL, 0x_11379625747D5AF3UL,
            0x_BCE5D2248682C115UL, 0x_9DA4243DE836994FUL, 0x_066F70B33FE09017UL, 0x_4DC4DE189B671A1CUL,
            0x_51039AB7712457C3UL, 0x_C07A3F80C31FB4B4UL, 0x_B46EE9C5E64A6E7CUL, 0x_B3819A42ABE61C87UL,
            0x_21A007933A522A20UL, 0x_2DF16F761598AA4FUL, 0x_763C4A1371B368FDUL, 0x_F793C46702E086A0UL,
            0x_D7288E012AEB8D31UL, 0x_DE336A2A4BC1C44BUL, 0x_0BF692B38D079F23UL, 0x_2C604A7A177326B3UL,
            0x_4850E73E03EB6064UL, 0x_CFC447F1E53C8E1BUL, 0x_B05CA3F564268D99UL, 0x_9AE182C8BC9474E8UL,
            0x_A4FC4BD4FC5558CAUL, 0x_E755178D58FC4E76UL, 0x_69B97DB1A4C03DFEUL, 0x_F9B5B7C4ACC67C96UL,
            0x_FC6A82D64B8655FBUL, 0x_9C684CB6C4D24417UL, 0x_8EC97D2917456ED0UL, 0x_6703DF9D2924E97EUL,

            // White Knight (index 3)
            0x_C547F57E42A7444EUL, 0x_78E37644E7CAD29EUL, 0x_FE9A44E9362F05FAUL, 0x_08BD35CC38336615UL,
            0x_9315E5EB3A129ACEUL, 0x_94061B871E04DF75UL, 0x_DF1D9F9D784BA010UL, 0x_3BBA57B68871B59DUL,
            0x_D2B7ADEEDED1F73FUL, 0x_F7A255D83BC373F8UL, 0x_D7F4F2448C0CEB81UL, 0x_D95BE88CD210FFA7UL,
            0x_336F52F8FF4728E7UL, 0x_A74049DAC312AC71UL, 0x_A2F61BB6E437FDB5UL, 0x_4F2A5CB07F6A35B3UL,
            0x_87D380BDA5BF7859UL, 0x_16B9F7E06C453A21UL, 0x_7BA2484C8A0FD54EUL, 0x_F3A678CAD9A2E38CUL,
            0x_39B0BF7DDE437BA2UL, 0x_FCAF55C1BF8A4424UL, 0x_18FCF680573FA594UL, 0x_4C0563B89F495AC3UL,
            0x_40E087931A00930DUL, 0x_8CFFA9412EB642C1UL, 0x_68CA39053261169FUL, 0x_7A1EE967D27579E2UL,
            0x_9D1D60E5076F5B6FUL, 0x_3810E399B6F65BA2UL, 0x_32095B6D4AB5F9B1UL, 0x_35CAB62109DD038AUL,
            0x_A90B24499FCFAFB1UL, 0x_77A225A07CC2C6BDUL, 0x_513E5E634C70E331UL, 0x_4361C0CA3F692F12UL,
            0x_D941ACA44B20A45BUL, 0x_528F7C8602C5807BUL, 0x_52AB92BEB9613989UL, 0x_9D1DFA2EFC557F73UL,
            0x_722FF175F572C348UL, 0x_1D1260A51107FE97UL, 0x_7A249A57EC0C9BA2UL, 0x_04208FE9E8F7F2D6UL,
            0x_5A110C6058B920A0UL, 0x_0CD9A497658A5698UL, 0x_56FD23C8F9715A4CUL, 0x_284C847B9D887AAEUL,
            0x_04FEABFBBDB619CBUL, 0x_742E1E651C60BA83UL, 0x_9A9632E65904AD3CUL, 0x_881B82A13B51B9E2UL,
            0x_506E6744CD974924UL, 0x_B0183DB56FFC6A79UL, 0x_0ED9B915C66ED37EUL, 0x_5E11E86D5873D484UL,
            0x_F678647E3519AC6EUL, 0x_1B85D488D0F20CC5UL, 0x_DAB9FE6525D89021UL, 0x_0D151D86ADB73615UL,
            0x_A865A54EDCC0F019UL, 0x_93C42566AEF98FFBUL, 0x_99E7AFEABE000731UL, 0x_48CBFF086DDF285AUL,

            // Black Bishop (index 4)
            0x_7F9B6AF1EBF78BAFUL, 0x_58627E1A149BBA21UL, 0x_2CD16E2ABD791E33UL, 0x_D363EFF5F0977996UL,
            0x_0CE2A38C344A6EEDUL, 0x_1A804AADB9CFA741UL, 0x_907F30421D78C5DEUL, 0x_501F65EDB3034D07UL,
            0x_37624AE5A48FA6E9UL, 0x_957BAF61700CFF4EUL, 0x_3A6C27934E31188AUL, 0x_D49503536ABCA345UL,
            0x_088E049589C432E0UL, 0x_F943AEE7FEBF21B8UL, 0x_6C3B8E3E336139D3UL, 0x_364F6FFA464EE52EUL,
            0x_D60F6DCEDC314222UL, 0x_56963B0DCA418FC0UL, 0x_16F50EDF91E513AFUL, 0x_EF1955914B609F93UL,
            0x_565601C0364E3228UL, 0x_ECB53939887E8175UL, 0x_BAC7A9A18531294BUL, 0x_B344C470397BBA52UL,
            0x_65D34954DAF3CEBDUL, 0x_B4B81B3FA97511E2UL, 0x_B422061193D6F6A7UL, 0x_071582401C38434DUL,
            0x_7A13F18BBEDC4FF5UL, 0x_BC4097B116C524D2UL, 0x_59B97885E2F2EA28UL, 0x_99170A5DC3115544UL,
            0x_6F423357E7C6A9F9UL, 0x_325928EE6E6F8794UL, 0x_D0E4366228B03343UL, 0x_565C31F7DE89EA27UL,
            0x_30F5611484119414UL, 0x_D873DB391292ED4FUL, 0x_7BD94E1D8E17DEBCUL, 0x_C7D9F16864A76E94UL,
            0x_947AE053EE56E63CUL, 0x_C8C93882F9475F5FUL, 0x_3A9BF55BA91F81CAUL, 0x_D9A11FBB3D9808E4UL,
            0x_0FD22063EDC29FCAUL, 0x_B3F256D8ACA0B0B9UL, 0x_B03031A8B4516E84UL, 0x_35DD37D5871448AFUL,
            0x_E9F6082B05542E4EUL, 0x_EBFAFA33D7254B59UL, 0x_9255ABB50D532280UL, 0x_B9AB4CE57F2D34F3UL,
            0x_693501D628297551UL, 0x_C62C58F97DD949BFUL, 0x_CD454F8F19C5126AUL, 0x_BBE83F4ECC2BDECBUL,
            0x_DC842B7E2819E230UL, 0x_BA89142E007503B8UL, 0x_A3BC941D0A5061CBUL, 0x_E9F6760E32CD8021UL,
            0x_09C7E552BC76492FUL, 0x_852F54934DA55CC9UL, 0x_8107FCCF064FCF56UL, 0x_098954D51FFF6580UL,

            // White Bishop (index 5)
            0x_23B70EDB1955C4BFUL, 0x_C330DE426430F69DUL, 0x_4715ED43E8A45C0AUL, 0x_A8D7E4DAB780A08DUL,
            0x_0572B974F03CE0BBUL, 0x_B57D2E985E1419C7UL, 0x_E8D9ECBE2CF3D73FUL, 0x_2FE4B17170E59750UL,
            0x_11317BA87905E790UL, 0x_7FBF21EC8A1F45ECUL, 0x_1725CABFCB045B00UL, 0x_964E915CD5E2B207UL,
            0x_3E2B8BCBF016D66DUL, 0x_BE7444E39328A0ACUL, 0x_F85B2B4FBCDE44B7UL, 0x_49353FEA39BA63B1UL,
            0x_1DD01AAFCD53486AUL, 0x_1FCA8A92FD719F85UL, 0x_FC7C95D827357AFAUL, 0x_18A6A990C8B35EBDUL,
            0x_CCCB7005C6B9C28DUL, 0x_3BDBB92C43B17F26UL, 0x_AA70B5B4F89695A2UL, 0x_E94C39A54A98307FUL,
            0x_B7A0B174CFF6F36EUL, 0x_D4DBA84729AF48ADUL, 0x_2E18BC1AD9704A68UL, 0x_2DE0966DAF2F8B1CUL,
            0x_B9C11D5B1E43A07EUL, 0x_64972D68DEE33360UL, 0x_94628D38D0C20584UL, 0x_DBC0D2B6AB90A559UL,
            0x_D2733C4335C6A72FUL, 0x_7E75D99D94A70F4DUL, 0x_6CED1983376FA72BUL, 0x_97FCAACBF030BC24UL,
            0x_7B77497B32503B12UL, 0x_8547EDDFB81CCB94UL, 0x_79999CDFF70902CBUL, 0x_CFFE1939438E9B24UL,
            0x_829626E3892D95D7UL, 0x_92FAE24291F2B3F1UL, 0x_63E22C147B9C3403UL, 0x_C678B6D860284A1CUL,
            0x_5873888850659AE7UL, 0x_0981DCD296A8736DUL, 0x_9F65789A6509A440UL, 0x_9FF38FED72E9052FUL,
            0x_E479EE5B9930578CUL, 0x_E7F28ECD2D49EECDUL, 0x_56C074A581EA17FEUL, 0x_5544F7D774B14AEFUL,
            0x_7B3F0195FC6F290FUL, 0x_12153635B2C0CF57UL, 0x_7F5126DBBA5E0CA7UL, 0x_7A76956C3EAFB413UL,
            0x_3D5774A11D31AB39UL, 0x_8A1B083821F40CB4UL, 0x_7B4A38E32537DF62UL, 0x_950113646D1D6E03UL,
            0x_4DA8979A0041E8A9UL, 0x_3BC36E078F7515D7UL, 0x_5D0A12F27AD310D1UL, 0x_7F9D1A2E1EBE1327UL,

            // Black Rook (index 6)
            0x_DA3A361B1C5157B1UL, 0x_DCDD7D20903D0C25UL, 0x_36833336D068F707UL, 0x_CE68341F79893389UL,
            0x_AB9090168DD05F34UL, 0x_43954B3252DC25E5UL, 0x_B438C2B67F98E5E9UL, 0x_10DCD78E3851A492UL,
            0x_DBC27AB5447822BFUL, 0x_9B3CDB65F82CA382UL, 0x_B67B7896167B4C84UL, 0x_BFCED1B0048EAC50UL,
            0x_A9119B60369FFEBDUL, 0x_1FFF7AC80904BF45UL, 0x_AC12FB171817EEE7UL, 0x_AF08DA9177DDA93DUL,
            0x_1B0CAB936E65C744UL, 0x_B559EB1D04E5E932UL, 0x_C37B45B3F8D6F2BAUL, 0x_C3A9DC228CAAC9E9UL,
            0x_F3B8B6675A6507FFUL, 0x_9FC477DE4ED681DAUL, 0x_67378D8ECCEF96CBUL, 0x_6DD856D94D259236UL,
            0x_A319CE15B0B4DB31UL, 0x_073973751F12DD5EUL, 0x_8A8E849EB32781A5UL, 0x_E1925C71285279F5UL,
            0x_74C04BF1790C0EFEUL, 0x_4DDA48153C94938AUL, 0x_9D266D6A1CC0542CUL, 0x_7440FB816508C4FEUL,
            0x_13328503DF48229FUL, 0x_D6BF7BAEE43CAC40UL, 0x_4838D65F6EF6748FUL, 0x_1E152328F3318DEAUL,
            0x_8F8419A348F296BFUL, 0x_72C8834A5957B511UL, 0x_D7A023A73260B45CUL, 0x_94EBC8ABCFB56DAEUL,
            0x_9FC10D0F989993E0UL, 0x_DE68A2355B93CAE6UL, 0x_A44CFE79AE538BBEUL, 0x_9D1D84FCCE371425UL,
            0x_51D2B1AB2DDFB636UL, 0x_2FD7E4B9E72CD38CUL, 0x_65CA5B96B7552210UL, 0x_DD69A0D8AB3B546DUL,
            0x_604D51B25FBF70E2UL, 0x_73AA8A564FB7AC9EUL, 0x_1A8C1E992B941148UL, 0x_AAC40A2703D9BEA0UL,
            0x_764DBEAE7FA4F3A6UL, 0x_1E99B96E70A9BE8BUL, 0x_2C5E9DEB57EF4743UL, 0x_3A938FEE32D29981UL,
            0x_26E6DB8FFDF5ADFEUL, 0x_469356C504EC9F9DUL, 0x_C8763C5B08D1908CUL, 0x_3F6C6AF859D80055UL,
            0x_7F7CC39420A3A545UL, 0x_9BFB227EBDF4C5CEUL, 0x_89039D79D6FC5C5CUL, 0x_8FE88B57305E2AB6UL,

            // White Rook (index 7)
            0x_A09E8C8C35AB96DEUL, 0x_FA7E393983325753UL, 0x_D6B6D0ECC617C699UL, 0x_DFEA21EA9E7557E3UL,
            0x_B67C1FA481680AF8UL, 0x_CA1E3785A9E724E5UL, 0x_1CFC8BED0D681639UL, 0x_D18D8549D140CAEAUL,
            0x_4ED0FE7E9DC91335UL, 0x_E4DBF0634473F5D2UL, 0x_1761F93A44D5AEFFUL, 0x_53898E4C3910DA55UL,
            0x_734DE8181F6EC39AUL, 0x_2680B122BAA28D97UL, 0x_298AF231C85BAFABUL, 0x_7983EED3740847D5UL,
            0x_66C1A2A1A60CD889UL, 0x_9E17E49642A3E4C1UL, 0x_EDB454E7BADC0805UL, 0x_50B704CAB602C329UL,
            0x_4CC317FB9CDDD023UL, 0x_66B4835D9EAFEA22UL, 0x_219B97E26FFC81BDUL, 0x_261E4E4C0A333A9DUL,
            0x_1FE2CCA76517DB90UL, 0x_D7504DFA8816EDBFUL, 0x_B9571FA04DC089C8UL, 0x_1DDC0325259B27DEUL,
            0x_CF3F4688801EB9AAUL, 0x_F4F5D05C10CAB243UL, 0x_38B6525C21A42B0EUL, 0x_36F60E2BA4FA6800UL,
            0x_EB3593803173E0CEUL, 0x_9C4CD6257C5A3603UL, 0x_AF0C317D32ADAA8AUL, 0x_258E5A80C7204C4BUL,
            0x_8B889D624D44885DUL, 0x_F4D14597E660F855UL, 0x_D4347F66EC8941C3UL, 0x_E699ED85B0DFB40DUL,
            0x_2472F6207C2D0484UL, 0x_C2A1E7B5B459AEB5UL, 0x_AB4F6451CC1D45ECUL, 0x_63767572AE3D6174UL,
            0x_A59E0BD101731A28UL, 0x_116D0016CB948F09UL, 0x_2CF9C8CA052F6E9FUL, 0x_0B090A7560A968E3UL,
            0x_ABEEDDB2DDE06FF1UL, 0x_58EFC10B06A2068DUL, 0x_C6E57A78FBD986E0UL, 0x_2EAB8CA63CE802D7UL,
            0x_14A195640116F336UL, 0x_7C0828DD624EC390UL, 0x_D74BBE77E6116AC7UL, 0x_804456AF10F5FB53UL,
            0x_EBE9EA2ADF4321C7UL, 0x_03219A39EE587A30UL, 0x_49787FEF17AF9924UL, 0x_A1E9300CD8520548UL,
            0x_5B45E522E4B1B4EFUL, 0x_B49C3B3995091A36UL, 0x_D4490AD526F14431UL, 0x_12A8F216AF9418C2UL,

            // Black Queen (index 8)
            0x_001F837CC7350524UL, 0x_1877B51E57A764D5UL, 0x_A2853B80F17F58EEUL, 0x_993E1DE72D36D310UL,
            0x_B3598080CE64A656UL, 0x_252F59CF0D9F04BBUL, 0x_D23C8E176D113600UL, 0x_1BDA0492E7E4586EUL,
            0x_21E0BD5026C619BFUL, 0x_3B097ADAF088F94EUL, 0x_8D14DEDB30BE846EUL, 0x_F95CFFA23AF5F6F4UL,
            0x_3871700761B3F743UL, 0x_CA672B91E9E4FA16UL, 0x_64C8E531BFF53B55UL, 0x_241260ED4AD1E87DUL,
            0x_106C09B972D2E822UL, 0x_7FBA195410E5CA30UL, 0x_7884D9BC6CB569D8UL, 0x_0647DFEDCD894A29UL,
            0x_63573FF03E224774UL, 0x_4FC8E9560F91B123UL, 0x_1DB956E450275779UL, 0x_B8D91274B9E9D4FBUL,
            0x_A2EBEE47E2FBFCE1UL, 0x_D9F1F30CCD97FB09UL, 0x_EFED53D75FD64E6BUL, 0x_2E6D02C36017F67FUL,
            0x_A9AA4D20DB084E9BUL, 0x_B64BE8D8B25396C1UL, 0x_70CB6AF7C2D5BCF0UL, 0x_98F076A4F7A2322EUL,
            0x_BF84470805E69B5FUL, 0x_94C3251F06F90CF3UL, 0x_3E003E616A6591E9UL, 0x_B925A6CD0421AFF3UL,
            0x_61BDD1307C66E300UL, 0x_BF8D5108E27E0D48UL, 0x_240AB57A8B888B20UL, 0x_FC87614BAF287E07UL,
            0x_EF02CDD06FFDB432UL, 0x_A1082C0466DF6C0AUL, 0x_8215E577001332C8UL, 0x_D39BB9C3A48DB6CFUL,
            0x_2738259634305C14UL, 0x_61CF4F94C97DF93DUL, 0x_1B6BACA2AE4E125BUL, 0x_758F450C88572E0BUL,
            0x_959F587D507A8359UL, 0x_B063E962E045F54DUL, 0x_60E8ED72C0DFF5D1UL, 0x_7B64978555326F9FUL,
            0x_FD080D236DA814BAUL, 0x_8C90FD9B083F4558UL, 0x_106F72FE81E2C590UL, 0x_7976033A39F7D952UL,
            0x_A4EC0132764CA04BUL, 0x_733EA705FAE4FA77UL, 0x_B4D8F77BC3E56167UL, 0x_9E21F4F903B33FD9UL,
            0x_9D765E419FB69F6DUL, 0x_D30C088BA61EA5EFUL, 0x_5D94337FBFAF7F5BUL, 0x_1A4E4822EB4D7A59UL,

            // White Queen (index 9)
            0x_6FFE73E81B637FB3UL, 0x_DDF957BC36D8B9CAUL, 0x_64D0E29EEA8838B3UL, 0x_08DD9BDFD96B9F63UL,
            0x_087E79E5A57D1D13UL, 0x_E328E230E3E2B3FBUL, 0x_1C2559E30F0946BEUL, 0x_720BF5F26F4D2EAAUL,
            0x_B0774D261CC609DBUL, 0x_443F64EC5A371195UL, 0x_4112CF68649A260EUL, 0x_D813F2FAB7F5C5CAUL,
            0x_660D3257380841EEUL, 0x_59AC2C7873F910A3UL, 0x_E846963877671A17UL, 0x_93B633ABFA3469F8UL,
            0x_C0C0F5A60EF4CDCFUL, 0x_CAF21ECD4377B28CUL, 0x_57277707199B8175UL, 0x_506C11B9D90E8B1DUL,
            0x_D83CC2687A19255FUL, 0x_4A29C6465A314CD1UL, 0x_ED2DF21216235097UL, 0x_B5635C95FF7296E2UL,
            0x_22AF003AB672E811UL, 0x_52E762596BF68235UL, 0x_9AEBA33AC6ECC6B0UL, 0x_944F6DE09134DFB6UL,
            0x_6C47BEC883A7DE39UL, 0x_6AD047C430A12104UL, 0x_A5B1CFDBA0AB4067UL, 0x_7C45D833AFF07862UL,
            0x_5092EF950A16DA0BUL, 0x_9338E69C052B8E7BUL, 0x_455A4B4CFE30E3F5UL, 0x_6B02E63195AD0CF8UL,
            0x_6B17B224BAD6BF27UL, 0x_D1E0CCD25BB9C169UL, 0x_DE0C89A556B9AE70UL, 0x_50065E535A213CF6UL,
            0x_9C1169FA2777B874UL, 0x_78EDEFD694AF1EEDUL, 0x_6DC93D9526A50E68UL, 0x_EE97F453F06791EDUL,
            0x_32AB0EDB696703D3UL, 0x_3A6853C7E70757A7UL, 0x_31865CED6120F37DUL, 0x_67FEF95D92607890UL,
            0x_1F2B1D1F15F6DC9CUL, 0x_B69E38A8965C6B65UL, 0x_AA9119FF184CCCF4UL, 0x_F43C732873F24C13UL,
            0x_FB4A3D794A9A80D2UL, 0x_3550C2321FD6109CUL, 0x_371F77E76BB8417EUL, 0x_6BFA9AAE5EC05779UL,
            0x_CD04F3FF001A4778UL, 0x_E3273522064480CAUL, 0x_9F91508BFFCFC14AUL, 0x_049A7F41061A9E60UL,
            0x_FCB6BE43A9F2FE9BUL, 0x_08DE8A1C7797DA9BUL, 0x_8F9887E6078735A1UL, 0x_B5B4071DBFC73A66UL,

            // Black King (index 10)
            0x_230E343DFBA08D33UL, 0x_43ED7F5A0FAE657DUL, 0x_3A88A0FBBCB05C63UL, 0x_21874B8B4D2DBC4FUL,
            0x_1BDEA12E35F6A8C9UL, 0x_53C065C6C8E63528UL, 0x_E34A1D250E7A8D6BUL, 0x_D6B04D3B7651DD7EUL,
            0x_5E90277E7CB39E2DUL, 0x_2C046F22062DC67DUL, 0x_B10BB459132D0A26UL, 0x_3FA9DDFB67E2F199UL,
            0x_0E09B88E1914F7AFUL, 0x_10E8B35AF3EEAB37UL, 0x_9EEDECA8E272B933UL, 0x_D4C718BC4AE8AE5FUL,
            0x_81536D601170FC20UL, 0x_91B534F885818A06UL, 0x_EC8177F83F900978UL, 0x_190E714FADA5156EUL,
            0x_B592BF39B0364963UL, 0x_89C350C893AE7DC1UL, 0x_AC042E70F8B383F2UL, 0x_B49B52E587A1EE60UL,
            0x_FB152FE3FF26DA89UL, 0x_3E666E6F69AE2C15UL, 0x_3B544EBE544C19F9UL, 0x_E805A1E290CF2456UL,
            0x_24B33C9D7ED25117UL, 0x_E74733427B72F0C1UL, 0x_0A804D18B7097475UL, 0x_57E3306D881EDB4FUL,
            0x_4AE7D6A36EB5DBCBUL, 0x_2D8D5432157064C8UL, 0x_D1E649DE1E7F268BUL, 0x_8A328A1CEDFE552CUL,
            0x_07A3AEC79624C7DAUL, 0x_84547DDC3E203C94UL, 0x_990A98FD5071D263UL, 0x_1A4FF12616EEFC89UL,
            0x_F6F7FD1431714200UL, 0x_30C05B1BA332F41CUL, 0x_8D2636B81555A786UL, 0x_46C9FEB55D120902UL,
            0x_CCEC0A73B49C9921UL, 0x_4E9D2827355FC492UL, 0x_19EBB029435DCB0FUL, 0x_4659D2B743848A2CUL,
            0x_963EF2C96B33BE31UL, 0x_74F85198B05A2E7DUL, 0x_5A0F544DD2B1FB18UL, 0x_03727073C2E134B1UL,
            0x_C7F6AA2DE59AEA61UL, 0x_352787BAA0D7C22FUL, 0x_9853EAB63B5E0B35UL, 0x_ABBDCDD7ED5C0860UL,
            0x_CF05DAF5AC8D77B0UL, 0x_49CAD48CEBF4A71EUL, 0x_7A4C10EC2158C4A6UL, 0x_D9E92AA246BF719EUL,
            0x_13AE978D09FE5557UL, 0x_730499AF921549FFUL, 0x_4E4B705B92903BA4UL, 0x_FF577222C14F0A3AUL,

            // White King (index 11)
            0x_55B6344CF97AAFAEUL, 0x_B862225B055B6960UL, 0x_CAC09AFBDDD2CDB4UL, 0x_DAF8E9829FE96B5FUL,
            0x_B5FDFC5D3132C498UL, 0x_310CB380DB6F7503UL, 0x_E87FBB46217A360EUL, 0x_2102AE466EBB1148UL,
            0x_F8549E1A3AA5E00DUL, 0x_07A69AFDCC42261AUL, 0x_C4C118BFE78FEAAEUL, 0x_F9F4892ED96BD438UL,
            0x_1AF3DBE25D8F45DAUL, 0x_F5B4B0B0D2DEEEB4UL, 0x_962ACEEFA82E1C84UL, 0x_046E3ECAAF453CE9UL,
            0x_F05D129681949A4CUL, 0x_964781CE734B3C84UL, 0x_9C2ED44081CE5FBDUL, 0x_522E23F3925E319EUL,
            0x_177E00F9FC32F791UL, 0x_2BC60A63A6F3B3F2UL, 0x_222BBFAE61725606UL, 0x_486289DDCC3D6780UL,
            0x_7DC7785B8EFDFC80UL, 0x_8AF38731C02BA980UL, 0x_1FAB64EA29A2DDF7UL, 0x_E4D9429322CD065AUL,
            0x_9DA058C67844F20CUL, 0x_24C0E332B70019B0UL, 0x_233003B5A6CFE6ADUL, 0x_D586BD01C5C217F6UL,
            0x_5E5637885F29BC2BUL, 0x_7EBA726D8C94094BUL, 0x_0A56A5F0BFE39272UL, 0x_D79476A84EE20D06UL,
            0x_9E4C1269BAA4BF37UL, 0x_17EFEE45B0DEE640UL, 0x_1D95B0A5FCF90BC6UL, 0x_93CBE0B699C2585DUL,
            0x_65FA4F227A2B6D79UL, 0x_D5F9E858292504D5UL, 0x_C2B5A03F71471A6FUL, 0x_59300222B4561E00UL,
            0x_CE2F8642CA0712DCUL, 0x_7CA9723FBB2E8988UL, 0x_2785338347F2BA08UL, 0x_C61BB3A141E50E8CUL,
            0x_150F361DAB9DEC26UL, 0x_9F6A419D382595F4UL, 0x_64A53DC924FE7AC9UL, 0x_142DE49FFF7A7C3DUL,
            0x_0C335248857FA9E7UL, 0x_0A9C32D5EAE45305UL, 0x_E6C42178C4BBB92EUL, 0x_71F1CE2490D20B07UL,
            0x_F1BCC3D275AFE51AUL, 0x_E728E8C83C334074UL, 0x_96FBF83A12884624UL, 0x_81A1549FD6573DA5UL,
            0x_5FA7867CAF35E149UL, 0x_56986E2EF3ED091BUL, 0x_917F1DD5F8886C61UL, 0x_D20D8C88C8FFE65FUL
        };

        #endregion
    }
}
